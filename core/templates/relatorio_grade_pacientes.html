{% extends 'base.html' %}

{% block content %}
<style>
    /* Estilo inspirado na imagem Excel enviada */
    .grade-header {
        background-color: #d0bcff; /* Lilás claro */
        border: 2px solid #000;
        text-align: center;
        font-weight: bold;
        padding: 5px;
        color: #000;
        text-transform: uppercase;
    }
    
    .paciente-box {
        border: 2px solid #000;
        background-color: white;
        font-weight: bold;
        padding: 8px 15px;
        margin-bottom: 2px;
        display: inline-block;
        min-width: 200px;
    }

    .tabela-excel {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 40px;
        font-size: 0.85rem;
    }

    .tabela-excel th {
        background-color: #d0bcff; /* Cabeçalho Roxo */
        border: 1px solid #000;
        padding: 8px;
        text-align: center;
        color: black;
        width: 18%; /* Distribui dias igualmente */
    }
    
    .tabela-excel th.th-hora {
        width: 10%;
        background-color: white;
        border: none;
    }

    .tabela-excel td {
        border: 1px solid #000;
        padding: 8px;
        text-align: center;
        background-color: white;
        height: 40px;
        vertical-align: middle;
    }

    .tabela-excel td.td-hora {
        font-weight: bold;
        border: 2px solid #000;
        background-color: white;
        width: 10%;
    }

    .celula-vazia {
        background-color: white;
    }
</style>

<div class="container-fluid px-0">
    <div class="row mb-4">
        <div class="col-12">
            <div class="grade-header mb-4 fs-5">
                Pacientes UP - Grade de Horários Fixos
            </div>
        </div>
    </div>

    {% for item in relatorio %}
    <div class="mb-2">
        <div class="paciente-box">
            {{ item.paciente.nome }}
        </div>

        <table class="tabela-excel">
            <thead>
                <tr>
                    <th class="th-hora"></th> {% for dia in dias_semana %}
                        <th>{{ dia }}</th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                {% for linha in item.linhas %}
                <tr>
                    <td class="td-hora">
                        {{ linha.hora|date:"H:i" }}
                    </td>
                    
                    {% for col in linha.colunas %}
                        <td>
                            {% if col %}
                                {{ col }}
                            {% endif %}
                        </td>
                    {% endfor %}
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% empty %}
        <div class="alert alert-info text-center">
            Nenhuma agenda fixa cadastrada no sistema.
        </div>
    {% endfor %}
</div>
{% endblock %}